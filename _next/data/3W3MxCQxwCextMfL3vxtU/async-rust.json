{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var o=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=s=>l(s,\"__esModule\",{value:!0});var N=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),x=(s,e)=>{t(s);for(var c in e)l(s,c,{get:e[c],enumerable:!0})},u=(s,e,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let n of p(e))!m.call(s,n)&&n!==\"default\"&&l(s,n,{get:()=>e[n],enumerable:!(c=h(e,n))||c.enumerable});return s},w=s=>u(t(l(s!=null?r(o(s)):{},\"default\",s&&s.__esModule&&\"default\"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var d=N((v,i)=>{i.exports=_jsx_runtime});var b={};x(b,{default:()=>y,frontmatter:()=>f});var a=w(d()),f={title:\"A primer to Rust Async\",date:\"2020-02-10\",tags:[\"Rust\",\"Async\",\"Programming\"],draft:!1,summary:\"An introduction to Rust Async programming\",images:[],layout:\"PostLayout\"};function g(s){let e=Object.assign({p:\"p\",a:\"a\",code:\"code\",em:\"em\",h3:\"h3\",span:\"span\",pre:\"pre\",blockquote:\"blockquote\",strong:\"strong\",ul:\"ul\",li:\"li\",h4:\"h4\"},s.components),{wrapper:c}=e,n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.p,{children:[\"This article is not comprehensive on the Rust Async topic but could be an easy overview if you have no idea about \",(0,a.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Asynchrony_(computer_programming)\",children:\"Async Programming\"}),\" in Rust or in general. If you are wondering about the new \",(0,a.jsx)(e.code,{children:\"async/await\"}),\" keywords, Futures, and intrigued what \",(0,a.jsx)(e.a,{href:\"https://tokio.rs\",children:\"Tokio\"}),\" is useful for, then you should feel less clueless by the end.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Rust Async is the \",(0,a.jsx)(e.a,{href:\"https://blog.rust-lang.org/2019/11/07/Async-await-stable.html\",children:\"new hot thing\"}),\" in Rust's land. It has been hailed as a big milestone for Rust; especially for people developing highly performant networking applications. The long time for development, the different incompatible versions, and the various libraries; however, might made it \",(0,a.jsx)(e.em,{children:\"not\"}),\" very straightforward to grasp. There is a lot going and it's not obvious from where to start.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Let's start from the beginning.\"}),`\n`,(0,a.jsxs)(e.h3,{id:\"what-is-async\",children:[(0,a.jsx)(e.a,{href:\"#what-is-async\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is Async?\"]}),`\n`,(0,a.jsx)(e.p,{children:\"There are several articles, books and videos that goes in depth on Async; but I'll give you the short version: If you have a single processor and want to execute two tasks simultaneously (kind of), how would you do it? The solution is to run a little bit of the first task, then switch and run a little bit of the second task, then switch back, etc... until both tasks are complete.\"}),`\n`,(0,a.jsxs)(e.p,{children:[\"This is useful if you want to give the impression that the computer is running both tasks simultaneously and the computer is fast enough to trick the human eye (i.e.: multitasking). Another useful use-case is \",(0,a.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Input/output\",children:\"IO\"}),\" operations. When your program is waiting for a network response, your CPU is sitting idle. This is an ideal time to switch to another task.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"So how do we write Async code?\"}),`\n`,(0,a.jsx)(e.p,{children:\"First, let's start with some synchronous code.\"}),`\n`,(0,a.jsxs)(e.h3,{id:\"synchronous-code\",children:[(0,a.jsx)(e.a,{href:\"#synchronous-code\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Synchronous code\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Let's make a simple program that reads two files: \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" and \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\". We start with \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" and then move to \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\", in that order.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"We split the program into two files: \",(0,a.jsx)(e.code,{children:\"main.rs\"}),\" and \",(0,a.jsx)(e.code,{children:\"file.rs\"}),\". \",(0,a.jsx)(e.code,{children:\"file.rs\"}),\" has a single function: \",(0,a.jsx)(e.code,{children:\"read_file\"}),\", and in \",(0,a.jsx)(e.code,{children:\"main.rs\"}),\" we call this function with the path of each file. You can find the code below.\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"file.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"fs\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"str\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" file \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"open\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_to_string\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"program started\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" file1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file1.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"processed file 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" file2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file2.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"processed file 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"dbg!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),\"file1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"dbg!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),\"file2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Use \",(0,a.jsx)(e.code,{children:\"cargo run\"}),\" to compile and run the program. The program should run with no surprises but make sure you have placed two files (\",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" and \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\") in your \",(0,a.jsx)(e.code,{children:\"src\"}),\" folder.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsx)(e.span,{className:\"code-line\",children:`program started\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"processed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"processed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"[\"}),\"src/main.rs:14\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"]\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),\"file1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"text-code-green\",children:['\"file 1',(0,a.jsx)(e.span,{className:\"\",title:\"\\\\n\",children:\"\\\\n\"}),'\"']}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"[\"}),\"src/main.rs:15\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"]\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),\"file2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"text-code-green\",children:['\"file 2',(0,a.jsx)(e.span,{className:\"\",title:\"\\\\n\",children:\"\\\\n\"}),'\"']}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"So far, all is good. If you need \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" processed before \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\", then this is the only way to go. But there are other times when you don't care of the order each file is processed. Ideally, you would be looking to have the files processed as fast as possible.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"In that case, we can make use of multi-threading.\"}),`\n`,(0,a.jsxs)(e.h3,{id:\"the-multi-threading-approach\",children:[(0,a.jsx)(e.a,{href:\"#the-multi-threading-approach\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"The multi-threading approach\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"For this, we run a separate thread for each function call. Since we are using multi-threaded code, and if we want to access the file contents outside the threads, we have to use one of the \",(0,a.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/sync/\",children:\"sync primitives\"}),\" that Rust provides.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Here is how it will affect the code: \",(0,a.jsx)(e.code,{children:\"file.rs\"}),\" will stay the same, so that's one thing already taken care of. In \",(0,a.jsx)(e.code,{children:\"main.rs\"}),\", we need to initialize two \",(0,a.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/sync/struct.RwLock.html\",children:\"RwLock\"}),\"s; these will be used later in the threads to store the file contents.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Then, we run an infinite loop where we try to read the content of these two variables. If these variables are not empty, then we know that the file processing (or reading) completed. (This means that the files shouldn't be empty; otherwise our program will just keep, mistakenly, waiting. An alternative is to use \",(0,a.jsx)(e.code,{children:\"Option<String>\"}),\" and check if the \",(0,a.jsx)(e.code,{children:\"Option\"}),\" in \",(0,a.jsx)(e.code,{children:\"None\"}),\").\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"If you need more overview about RwLock and multi-threading, you can check my previous article: \",(0,a.jsx)(e.a,{href:\"https://omarabid.com/rust-intro\",children:\"A brief introduction to Rust\"}),\".\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsxs)(e.em,{children:[\"This code requires the \",(0,a.jsx)(e.a,{href:\"https://crates.io/crates/lazy_static\",children:\"lazy_static\"}),\" crate.\"]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"sync\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"lazy_static\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"lazy_static\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// A sync primitive that allows to read/write from variables between threads.\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// we declare the variables here, this requires the lazy_static crate\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"lazy_static!\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"static\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"ref\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"static\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"ref\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"program started\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" thread_1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"spawn\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),(0,a.jsx)(e.span,{className:\"\",children:\"|\"})]}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" w1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"write\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"w1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file1.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"read file 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Launched Thread 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" thread_2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"spawn\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),(0,a.jsx)(e.span,{className:\"\",children:\"|\"})]}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" w2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"write\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"w2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file2.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"read file 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Launched Thread 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" rf1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"bool\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" rf2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"bool\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"loop\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"r1 \",(0,a.jsx)(e.span,{className:\"\",children:\"!=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&&\"}),\" rf1 \",(0,a.jsx)(e.span,{className:\"\",children:\"==\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"completed file 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            rf1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"true\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"r2 \",(0,a.jsx)(e.span,{className:\"\",children:\"!=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&&\"}),\" rf2 \",(0,a.jsx)(e.span,{className:\"\",children:\"==\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"completed file 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            rf2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"true\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Interestingly, if we have a very large \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\", we get a strange output. The second file is processed first (\",(0,a.jsx)(e.em,{children:\"read file 2\"}),\"); but inside our loop, the program seems to block and wait for the first file.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsx)(e.span,{className:\"code-line\",children:`program started\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Launched Thread \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Launched Thread \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"read\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"read\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"completed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"completed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Multi-threading can be a bit tricky because we have to account for the \",(0,a.jsx)(e.a,{href:\"https://stackoverflow.com/questions/52196678/what-are-atomic-operations-for-newbies\",children:\"atomic operations\"}),\" which can be \",(0,a.jsx)(e.em,{children:\"blocking\"}),\". We used the \",(0,a.jsx)(e.code,{children:\"read\"}),\" function to unlock our variable, and the \",(0,a.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/sync/struct.RwLock.html\",children:\"documentation\"}),\" warns about this behavior.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"Locks this rwlock with shared read access, blocking the current thread until it can be acquired.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Luckily, there is a \",(0,a.jsx)(e.code,{children:\"try_read\"}),\" function which returns an \",(0,a.jsx)(e.code,{children:\"Err\"}),\" if the lock can't be acquired.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"Attempts to acquire this rwlock with shared read access.\"}),`\n`,(0,a.jsxs)(e.p,{children:[\"If the access could not be granted at this time, then \",(0,a.jsx)(e.code,{children:\"Err\"}),\" is returned. Otherwise, an RAII guard is returned which will release the shared access when it is dropped.\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"In this second attempt, we use \",(0,a.jsx)(e.code,{children:\"try_read\"}),\" and ignore the \",(0,a.jsx)(e.code,{children:\"Err\"}),\"s returned since they should mean our lock is busy. This helps moving our program to the next variable, and handles the one which gets ready first.\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"sync\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"lazy_static\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"lazy_static\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"lazy_static!\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"static\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"ref\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"static\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"ref\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"RwLock\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"program started\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" thread_1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"spawn\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),(0,a.jsx)(e.span,{className:\"\",children:\"|\"})]}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" w1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"write\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"w1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file1.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"read file 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Launched Thread 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" thread_2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"thread\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"spawn\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),(0,a.jsx)(e.span,{className:\"\",children:\"|\"})]}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" w2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"write\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"w2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file2.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"read file 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Launched Thread 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" rf1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"bool\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" rf2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"bool\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"loop\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"try_read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"FILE2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"try_read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"match\"}),\" r1 \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"v\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"v \",(0,a.jsx)(e.span,{className:\"\",children:\"!=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&&\"}),\" rf1 \",(0,a.jsx)(e.span,{className:\"\",children:\"==\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"completed file 1\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                    rf1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"true\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// If rwlock can't be acquired, ignore the error\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Err\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"_\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"match\"}),\" r2 \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"v\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),\"v \",(0,a.jsx)(e.span,{className:\"\",children:\"!=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"from\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&&\"}),\" rf2 \",(0,a.jsx)(e.span,{className:\"\",children:\"==\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"false\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"completed file 2\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                    rf2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-red\",children:\"true\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// If rwlock can't be acquired, ignore the error\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Err\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"_\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Now the execution is different. If \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" is much bigger than \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\", then the second file should be processed first.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsx)(e.span,{className:\"code-line\",children:`program started\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Launched Thread \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Launched Thread \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"read\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"completed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"read\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"completed \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.h3,{id:\"the-limits-of-multi-threading\",children:[(0,a.jsx)(e.a,{href:\"#the-limits-of-multi-threading\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"The limits of multi-threading\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Why do we need Async if we already have multi-threading? There are two main advantages: performance and simplicity. Spawning threads is expensive; and as you can conclude from the above, writing multi-threaded code can get quite complicated.\"}),`\n`,(0,a.jsxs)(e.p,{children:[\"This answer on \",(0,a.jsx)(e.a,{href:\"https://stackoverflow.com/a/42861328/12637\",children:\"stackoverflow\"}),\" touches up on these points.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:\"Why is async considered better performing than multi-threading?\"})}),`\n`]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"When your code CPU-bound, there will be a little difference between between Tasks + async/await and pure multi-threaded code. In IO bound code, multi threading is the worst throughput you can have. Tasks + async/await will blow away any IO-bound-threadpool you can write your own. threads don't scale. usually (especially on Server side) you have both. you read some data from a connection (IO), then continue processing it on the CPU (json parsing, calculations etc.) and write the result back to the connection (IO again). Tasks + async/await are faster in this case than a pure multi threaded code.\"}),`\n`,(0,a.jsx)(e.p,{children:`It's the simplicity which makes async/await so appealing. writing a synchronous code which is actually asynchronous. if this is not \"high level programing\", what is?`}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"And that's where Rust Async comes in. Here is a quote for Aaron Turon from \",(0,a.jsx)(e.a,{href:\"https://aturon.github.io/blog/2016/08/11/futures/\",children:\"Zero-cost futures in Rust\"}),\" .\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"We\\u2019ve wanted something higher level, with better ergonomics, but also better composability, supporting an ecosystem of asynchronous abstractions that all work together. This story might sound familiar: it\\u2019s the same goal that\\u2019s led to the introduction of futures (aka promises) in many languages, with some supporting async/await sugar on top.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.h3,{id:\"async-the-keywords\",children:[(0,a.jsx)(e.a,{href:\"#async-the-keywords\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Async, the keywords\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Rust focus is to make writing Async code as simple as it can get. You only need to add the \",(0,a.jsx)(e.code,{children:\"async/await\"}),\" keywords to make your code Async: \",(0,a.jsx)(e.code,{children:\"async\"}),\" before the function declaration and \",(0,a.jsx)(e.code,{children:\"await\"}),\" to resolve your \",(0,a.jsx)(e.code,{children:\"async\"}),\" functions.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"That sounds great. Let's give it a try.\"}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"file.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"fs\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Read\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"str\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" file \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"open\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_to_string\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file1.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file2.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" f1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" r1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" f2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" r2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"dbg!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"f1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"dbg!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"f2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"This doesn't work, however. \",(0,a.jsx)(e.code,{children:\"await\"}),\" is available only inside an \",(0,a.jsx)(e.code,{children:\"async\"}),\" block or function. If we try to run this code, the compiler will throw this error.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"error\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"[\"}),\"E0728\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"]\"}),\": \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"await\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),\" is only allowed inside \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"async\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),` functions and blocks\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\" --\",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),` src/main.rs:9:14\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"5\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\" fn main\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" -\",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" io::Result\",(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\"    ---- this is not \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"async\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"..\"}),`.\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"9\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\"     \",(0,a.jsx)(e.span,{className:\"\",children:\"let\"}),\" f1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" r1.await\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\"              ^^^^^^^^ only allowed inside \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"async\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),` functions and blocks\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Can we make the \",(0,a.jsx)(e.code,{children:\"main\"}),\" function async? Unfortunately, it's not that simple; we get another error.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"error\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"[\"}),\"E0277\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"]\"}),\": \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"main\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),\" has invalid \",(0,a.jsx)(e.span,{className:\"\",children:\"return\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"type\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"impl std::future::Future\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\" --\",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),` src/main.rs:5:20\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"5\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\" async fn main\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" -\",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" io::Result\",(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),\"                    ^^^^^^^^^^^^^^ \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"main\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),\" can only \",(0,a.jsx)(e.span,{className:\"\",children:\"return\"}),\" types that implement \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"std::process::Termination\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"|\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" help: consider using \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),\", or a \",(0,a.jsxs)(e.span,{className:\"\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"`\"}),\"Result\",(0,a.jsx)(e.span,{className:\"\",children:\"`\"})]}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"The error message is a bit intriguing, though. It seems that the \",(0,a.jsx)(e.code,{children:\"async\"}),\" keyword makes our function return a \",(0,a.jsx)(e.code,{children:\"Future\"}),\" instead of the declared type.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Here is some excerpt from the \",(0,a.jsx)(e.a,{href:\"https://github.com/rust-lang/rfcs/blob/master/text/2394-async_await.md\",children:\"async-await RFC\"}),\".\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:'The return type of an async function is a unique anonymous type generated by the compiler, similar to the type of a closure. You can think of this type as being like an enum, with one variant for every \"yield point\" of the function - the beginning of it, the await expressions, and every return. Each variant stores the state that is needed to be stored to resume control from that yield point.'}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The return type of an async function is a \",(0,a.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/future/trait.Future.html\",children:\"Future\"}),\" (precisely, a closure that implements the Future trait).\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"The anonymous return type implements Future, with the return type as its Item.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"What about \",(0,a.jsx)(e.code,{children:\"await\"}),\"? From the same RFC.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"The await! builtin expands roughly to this:\"}),`\n`]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" future \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"IntoFuture\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"into_future\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"$expression\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" pin \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"unsafe\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Pin\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new_unchecked\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" future\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"loop\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"match\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Future\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Pin\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"borrow\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" pin\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" ctx\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Ready\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"item\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"break\"}),\" item\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Pending\"}),\"     \",(0,a.jsx)(e.span,{className:\"\",children:\"=>\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"yield\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"This is not a literal expansion, because the yield concept cannot be expressed in the surface syntax within async functions. This is why await! is a compiler builtin instead of an actual macro.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"So roughly speaking: \",(0,a.jsx)(e.code,{children:\"async\"}),\" makes our function a \",(0,a.jsx)(e.code,{children:\"Future\"}),\". \",(0,a.jsx)(e.code,{children:\"await\"}),\" loops through that future until completion. However, there is another missing piece of the puzzle: Rust doesn't resolve the future on its own. We need an executor that is going to run this Async code.\"]}),`\n`,(0,a.jsxs)(e.h3,{id:\"what-is-an-executor\",children:[(0,a.jsx)(e.a,{href:\"#what-is-an-executor\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is an executor?\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"If you rewind to our multi-threading example, you'll notice that we used a \",(0,a.jsx)(e.code,{children:\"loop\"}),\" in order to detect when our files were processed. It was simple: Loop infinitely until there is some content in the variable and then do something. We could have improved on that by breaking out of the loop if both files are read.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"An Async executor is the loop. Rust, by default, doesn't have any built-in executors. There is a number of Async run-times; \",(0,a.jsx)(e.a,{href:\"https://async.rs/\",children:\"async-std\"}),\" and \",(0,a.jsx)(e.a,{href:\"https://tokio.rs/\",children:\"Tokio\"}),\" being the most popular ones. The job of a run-time is to poll your async functions (\",(0,a.jsx)(e.code,{children:\"Future\"}),\"s) until they finally return a value.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"This \",(0,a.jsx)(e.a,{href:\"https://www.reddit.com/r/rust/comments/d1obg6/with_asyncawait_i_dont_get_what_runs_the_await/ezoxzjn/\",children:\"discussion\"}),\" on Reddit has more details, but you can ignore the specifics for now.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"Creating/Composing a future object (for example, by calling an async function which calls another async function) does not involve any progress. Only when you pass it to something that actively polls it, the future object starts its work and makes progress (poll by poll). At that point, we refer to the whole future thingy as a task. A suspension point simply makes a call to the future's poll method return immediately with a Poll::Pending value if the value is not ready yet.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.h3,{id:\"a-simple-executor\",children:[(0,a.jsx)(e.a,{href:\"#a-simple-executor\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"A simple executor\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The \",(0,a.jsx)(e.a,{href:\"https://crates.io/crates/futures\",children:\"futures\"}),\" crate has a very basic executor, and a function to join two \",(0,a.jsx)(e.code,{children:\"Future\"}),\"s. Let's give it a shot.\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsxs)(e.em,{children:[\"The following code uses the \",(0,a.jsx)(e.a,{href:\"https://crates.io/crates/futures\",children:\"futures\"}),\" crate version 0.3.4\"]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"futures\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"executor\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"block_on\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"futures\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"join\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Program started\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Block on the final future\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"block_on\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"load_files\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"load_files\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Join the two futures together\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"join!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"load_file_1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"load_file_2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"load_file_1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r1 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file1.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"file 1 size: {}\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" r1\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"len\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"load_file_2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" r2 \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"src/file2.txt\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"file 2 size: {}\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" r2\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"unwrap\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"len\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"To verify the asynchronicity, I dumped a bunch of data in \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\". Rust is pretty fast; at the time of testing this, \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\" had over 5Gb of text.\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsx)(e.span,{className:\"code-line\",children:`Program started\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" size: \",(0,a.jsx)(e.span,{className:\"\",children:\"5430447414\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" size: \",(0,a.jsx)(e.span,{className:\"\",children:\"7\"}),`\n`]})]})}),`\n`,(0,a.jsx)(e.p,{children:\"Unfortunately, this looks like (and it is) blocking on the first file function, again.\"}),`\n`,(0,a.jsxs)(e.h3,{id:\"so-what-is-async-anyway\",children:[(0,a.jsx)(e.a,{href:\"#so-what-is-async-anyway\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"So what is Async anyway?\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Similar to multi-threading, there are some gotchas and things to worry about in Async programming. The truth is, the \",(0,a.jsx)(e.code,{children:\"async\"}),\" keyword doesn't magically make your code async; it just makes your function return a \",(0,a.jsx)(e.code,{children:\"Future\"}),\". You still have to do the heavy lifting of \",(0,a.jsx)(e.em,{children:\"scheduling\"}),\" your code execution.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"This means that your function has to return quickly that it's not ready instead of being stuck doing calculations. In our case, the clogging is happening specifically at \",(0,a.jsx)(e.code,{children:\"File::Open\"}),\" and \",(0,a.jsx)(e.code,{children:\"file.read_to_string\"}),\". These two functions are not \",(0,a.jsx)(e.code,{children:\"async\"}),\" and therefore block execution.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"We need to create an Async version of these two functions. Luckily, some handsome people over \",(0,a.jsx)(e.a,{href:\"https://async.rs/\",children:\"async-std\"}),\" did the hard work of rewriting the std library in Rust to an async version.\"]}),`\n`,(0,a.jsxs)(e.blockquote,{children:[`\n`,(0,a.jsx)(e.p,{children:\"This crate provides an async version of std. It provides all the interfaces you are used to, but in an async version and ready for Rust's async/await syntax.\"}),`\n`]}),`\n`,(0,a.jsxs)(e.h3,{id:\"file-io-with-async-std\",children:[(0,a.jsx)(e.a,{href:\"#file-io-with-async-std\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"File IO with async-std\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The only change we have to make is to replace our \",(0,a.jsx)(e.code,{children:\"std\"}),\" imports with \",(0,a.jsx)(e.code,{children:\"async_std\"}),\".\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsxs)(e.em,{children:[\"For the following example, we are using the \",(0,a.jsx)(e.a,{href:\"https://crates.io/crates/async-std/1.5.0\",children:\"async-std\"}),\" crate version 1.5.0\"]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"file.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// We use async_std instead of std, it's that simple.\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"async_std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"async_std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"fs\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"async_std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"prelude\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"*\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"read_file\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"str\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"io\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Result\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" file \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"File\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"open\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"path\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"let\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"String\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"new\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    file\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"read_to_string\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"await\"}),(0,a.jsx)(e.span,{className:\"\",children:\"?\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Ok\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),\"buffer\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"The code in \",(0,a.jsx)(e.code,{children:\"main.rs\"}),\" remains the same; the program is still using the \",(0,a.jsx)(e.code,{children:\"block_on\"}),\" executor from the \",(0,a.jsx)(e.code,{children:\"futures\"}),\" crates.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Compile and run the program. (make sure to have a fat \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\")\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsx)(e.span,{className:\"code-line\",children:`Program started\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" size: \",(0,a.jsx)(e.span,{className:\"\",children:\"7\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"file\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" size: \",(0,a.jsx)(e.span,{className:\"\",children:\"5430447414\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Finally! \",(0,a.jsx)(e.code,{children:\"file2.txt\"}),\" gets processed first and fast here, then the program moves to \",(0,a.jsx)(e.code,{children:\"file1.txt\"}),\".\"]}),`\n`,(0,a.jsxs)(e.h3,{id:\"manually-implementing-async-with-futures\",children:[(0,a.jsx)(e.a,{href:\"#manually-implementing-async-with-futures\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Manually implementing Async with Futures\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Let's recap what we learned so far:\"}),`\n`,(0,a.jsxs)(e.ul,{children:[`\n`,(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:\"async\"}),\" makes our function return a \",(0,a.jsx)(e.code,{children:\"Future\"}),\".\"]}),`\n`,(0,a.jsxs)(e.li,{children:[\"Running our \",(0,a.jsx)(e.code,{children:\"Future\"}),\" requires a run-time.\"]}),`\n`,(0,a.jsxs)(e.li,{children:[\"The run-time checks if our \",(0,a.jsx)(e.code,{children:\"Future\"}),\" is ready; and when ready returns its value.\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"One more thing to add: Rust futures are \",(0,a.jsx)(e.em,{children:\"lazy\"}),\". The executor doesn't constantly \",(0,a.jsx)(e.em,{children:\"poll\"}),\" the \",(0,a.jsx)(e.code,{children:\"Future\"}),\" but instead waits for the \",(0,a.jsx)(e.code,{children:\"Future\"}),\" to signal that it is due for a poll.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The future we will design is rather useless but could demonstrate how progress is made during execution. The future object holds some state (an \",(0,a.jsx)(e.code,{children:\"i32\"}),\" field named \",(0,a.jsx)(e.code,{children:\"counter\"}),\"). At each \",(0,a.jsx)(e.code,{children:\"poll\"}),\", we increment our \",(0,a.jsx)(e.code,{children:\"counter\"}),\" by one, and then schedule another \",(0,a.jsx)(e.code,{children:\"poll\"}),\".\"]}),`\n`,(0,a.jsx)(e.p,{children:\"To demonstrate task switching, we'll create two different Future types. Their functionality is identical, though.\"}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"main.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"futures\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"executor\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"block_on\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"futures\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),\"join\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mod\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"asyncop\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"asyncop\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Task1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"main\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Wait for the joined future completion\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"block_on\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"asyncop\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"async\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"asyncop\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Join the two futures\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"join!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"fut1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"fut2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Future 1\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"fut1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task1\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Task1\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),\" count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"0\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Future 2\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"fut2\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task2\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"\",children:\"Task2\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),\" count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"0\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:\"asyncop.rs\"})}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"future\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Future\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"pin\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"\",children:\"Pin\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"use\"}),\" \",(0,a.jsxs)(e.span,{className:\"\",children:[\"std\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),\"task\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"})]}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Context\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"#[derive(Debug)]\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"struct\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task1\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"i32\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"impl\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Future\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"for\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task1\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"type\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Output\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Pin\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"Self\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" cx\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Context\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"'_\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"Self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Output\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// If counter reaches 99, our future is ready\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count \",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"\",children:\"100\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Ready\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"else\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Task 1 Progress - {}\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Increment counter\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"get_mut\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count \",(0,a.jsx)(e.span,{className:\"\",children:\"+=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Schedule future for another poll()\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            cx\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"waker\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"clone\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"wake\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Pending\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"\",children:\"#[derive(Debug)]\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"struct\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task2\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"pub\"}),\" count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"i32\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"impl\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Future\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"for\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Task2\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"type\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Output\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"=\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"fn\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Pin\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"Self\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" cx\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\":\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"mut\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Context\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"\",children:\"'_\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"->\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"\",children:\"<\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"Self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Output\"}),(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// If counter reaches 99, our future is ready\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"if\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count \",(0,a.jsx)(e.span,{className:\"\",children:\">\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"\",children:\"100\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Ready\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"else\"}),\" \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"{\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"println!\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-green\",children:'\"Task 2 Progress - {}\"'}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\",\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"&\"}),(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Increment counter\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-code-purple\",children:\"self\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"get_mut\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),\"count \",(0,a.jsx)(e.span,{className:\"\",children:\"+=\"}),\" \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"text-gray-400 italic\",children:\"// Schedule future for another poll()\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            cx\",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"waker\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"clone\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\".\"}),(0,a.jsx)(e.span,{className:\"text-code-blue\",children:\"wake\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\")\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\";\"}),`\n`]}),(0,a.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,a.jsx)(e.span,{className:\"\",children:\"Poll\"}),(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"::\"}),(0,a.jsx)(e.span,{className:\"\",children:\"Pending\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"}\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"The output on execution demonstrates how the executor is switching between \",(0,a.jsx)(e.em,{children:\"Future 1\"}),\" and \",(0,a.jsx)(e.em,{children:\"Future 2\"}),\".\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,a.jsxs)(e.span,{className:\"code-line\",children:[(0,a.jsx)(e.span,{className:\"text-code-white\",children:\"..\"}),`.\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"95\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"95\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"96\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"96\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"97\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"97\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"98\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"98\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"99\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"99\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"1\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"100\"}),`\n`]}),(0,a.jsxs)(e.span,{className:\"code-line\",children:[\"Task \",(0,a.jsx)(e.span,{className:\"\",children:\"2\"}),\" Progress - \",(0,a.jsx)(e.span,{className:\"\",children:\"100\"}),`\n`]})]})}),`\n`,(0,a.jsxs)(e.h3,{id:\"wrap-up\",children:[(0,a.jsx)(e.a,{href:\"#wrap-up\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Wrap-up\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"In this post we covered synchronous code, multi-threaded code, some Async terminology in Rust, the async-std library and a simple \",(0,a.jsx)(e.code,{children:\"Future\"}),\" implementation. This is, really, a lightweight introduction and many of the specifics were omitted for brevity.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"I've compiled a list of resources below if you want to explore more.\"}),`\n`,(0,a.jsxs)(e.h4,{id:\"further-resources-on-async-rust\",children:[(0,a.jsx)(e.a,{href:\"#further-resources-on-async-rust\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Further resources on Async Rust\"]}),`\n`,(0,a.jsxs)(e.ul,{children:[`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://rust-lang.github.io/async-book/\",children:\"Asynchronous Programming in Rust\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://cfsamson.github.io/book-exploring-async-basics/introduction.html\",children:\"The Node Experiment - Exploring Async Basics with Rust\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://cfsamson.gitbook.io/green-threads-explained-in-200-lines-of-rust/\",children:\"Green threads explained in 200 lines of Rust\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://www.viget.com/articles/understanding-futures-in-rust-part-1/\",children:\"Understanding Futures In Rust -- Part 1\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://www.viget.com/articles/understanding-futures-is-rust-part-2/\",children:\"Understanding Futures In Rust -- Part 2\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://dev.to/iam_aprogrammer/pinning-asynchronous-programming-in-rust-why-what-and-how-3eal\",children:\"Pinning - Asynchronous Programming in Rust: Why, What, and How\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://tmandry.gitlab.io/blog/posts/optimizing-await-1/\",children:\"How Rust optimizes async/await I\"})}),`\n`,(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:\"https://tmandry.gitlab.io/blog/posts/optimizing-await-2/\",children:\"How Rust optimizes async/await II: Program analysis\"})}),`\n`]})]});return c?(0,a.jsx)(c,Object.assign({},s,{children:n})):n}var y=g;return b;})();\n;return Component.default;","toc":[{"value":"What is Async?","url":"#what-is-async","depth":3},{"value":"Synchronous code","url":"#synchronous-code","depth":3},{"value":"The multi-threading approach","url":"#the-multi-threading-approach","depth":3},{"value":"The limits of multi-threading","url":"#the-limits-of-multi-threading","depth":3},{"value":"Async, the keywords","url":"#async-the-keywords","depth":3},{"value":"What is an executor?","url":"#what-is-an-executor","depth":3},{"value":"A simple executor","url":"#a-simple-executor","depth":3},{"value":"So what is Async anyway?","url":"#so-what-is-async-anyway","depth":3},{"value":"File IO with async-std","url":"#file-io-with-async-std","depth":3},{"value":"Manually implementing Async with Futures","url":"#manually-implementing-async-with-futures","depth":3},{"value":"Wrap-up","url":"#wrap-up","depth":3},{"value":"Further resources on Async Rust","url":"#further-resources-on-async-rust","depth":4}],"frontMatter":{"readingTime":{"text":"18 min read","minutes":17.44,"time":1046400,"words":3488},"slug":"async-rust","fileName":"async-rust.md","title":"A primer to Rust Async","date":"2020-02-10T00:00:00.000Z","tags":["Rust","Async","Programming"],"draft":false,"summary":"An introduction to Rust Async programming","images":[],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.205,"time":12300,"words":41},"slug":["default"],"fileName":"default.md","name":"Abid Omar","avatar":"/static/images/avatar.png","occupation":"Entrepreneur","company":"Aderbal","email":"contact@omarabid.com","github":"https://github.com/omarabid","date":null}],"prev":{"title":"The modern web is becoming an unusable, user-hostile wasteland","date":"2019-12-20T00:00:00.000Z","tags":["Web","Programming"],"draft":false,"summary":"Some thoughts about the modern web","images":[],"layout":"PostLayout","slug":"the-modern-web"},"next":{"title":"Examining the complex web of USD stable coins","date":"2020-06-05T00:00:00.000Z","tags":["Crypto","Defi"],"draft":false,"summary":"A brief look on some USD stable coins","images":[],"layout":"PostLayout","slug":"usd-stable-coins"}},"__N_SSG":true}